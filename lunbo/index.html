<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>移动端多效果轮播模板（最终修复版）</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <style>
      /* ========== 全局重置与基础样式 (移动端优先) ========== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background-color: #000;
        font-family: 'Arial', 'Helvetica', sans-serif;
        padding: 10px;
      }

      /* 效果切换按钮容器 */
      .effect-switcher {
        position: fixed;
        top: 10px;
        left: 0;
        width: 100%;
        z-index: 99;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        padding: 10px;
        background: rgba(0, 0, 0, 0.8);
        justify-content: center;
      }

      .effect-btn {
        padding: 6px 12px;
        border: 1px solid #fff;
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        border-radius: 4px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .effect-btn.active {
        background: #fff;
        color: #000;
      }

      /* ========== Hero轮播容器核心样式 (移动端适配) ========== */
      .hero {
        position: relative;
        width: 100%;
        height: 70vh;
        overflow: hidden;
        color: #ffffff;
        margin-top: 70px;
      }

      /* ========== 中层：Swiper轮播卡片 ========== */
      .hero-items {
        position: relative;
        z-index: 2;
        width: 100%;
        height: 100%;
        padding: 15px;
      }

      .swiper-wrapper {
        height: 100%;
      }

      /* 基础轮播项样式 */
      .hero-item {
        position: relative;
        width: 100%;
        height: 100%;
        border-radius: 8px;
        overflow: hidden;
        background: rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(4px);
      }

      /* 效果2：卡片堆叠专用样式 */
      .hero.effect-stack .hero-item {
        width: 85%;
        margin: 0 auto;
        opacity: 0.6;
        transform: scale(0.9);
        transition: all 0.3s ease;
      }
      .hero.effect-stack .swiper-slide-active {
        opacity: 1;
        transform: scale(1);
        z-index: 10;
      }
      .hero.effect-stack .swiper-slide-next {
        opacity: 0.8;
        transform: scale(0.95);
      }

      /* 效果3：3D封面流专用样式 */
      .hero.effect-cube .hero-item {
        width: 80%;
        margin: 0 auto;
        transform-origin: center;
      }

      /* 效果5：无限卡片专用样式 */
      .hero.effect-cards .hero-item {
        width: 75%;
        margin: 0 8px;
        height: 80%;
      }
      .hero.effect-cards .hero-items {
        overflow: visible !important;
        padding: 0 20px !important;
      }
      .hero.effect-cards .swiper-slide {
        display: inline-block;
        vertical-align: middle;
      }

      /* 效果6：居中缩放专用样式（核心修改） */
      .hero.effect-scale .hero-items {
        overflow: visible !important;
      }
      .hero.effect-scale .hero-item {
        width: 80%; /* 缩小卡片宽度，突出居中效果 */
        margin: 0 auto;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* 更丝滑的过渡 */
        opacity: 0.4;
        transform: scale(0.8) translateZ(0); /* 加translateZ增强3D感 */
        z-index: 1;
      }
      .hero.effect-scale .swiper-slide-active {
        opacity: 1;
        transform: scale(1) translateZ(0);
        z-index: 10;
      }
      .hero.effect-scale .swiper-slide-prev,
      .hero.effect-scale .swiper-slide-next {
        opacity: 0.6;
        transform: scale(0.9) translateZ(0);
        z-index: 5;
      }

      .hero-item-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: block;
        cursor: pointer;
      }

      .hero-item-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      /* 轮播卡片文字区域 */
      .hero-item-detail {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 15px;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
        z-index: 3;
      }

      .hero-item-link {
        text-decoration: none;
        color: #ffffff;
        display: block;
      }

      .hero-item-title {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 6px;
      }

      .hero-item-description {
        font-size: 12px;
        opacity: 0.8;
        margin-bottom: 8px;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .hero-item-category {
        font-size: 10px;
        padding: 2px 6px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 4px;
      }

      /* ========== 底层：模糊背景层 ========== */
      .hero-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
      }

      .hero-bg-cover {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
      }

      .hero-bg-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        filter: blur(8px) brightness(0.7);
        transform: scale(1.05);
        overflow: hidden;
      }

      .hero-bg-image img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0;
        transition: opacity 0.6s ease;
      }

      .hero-bg-image img.is-active {
        opacity: 1;
      }

      /* ========== 顶层：控制元素 ========== */
      .hero-controls {
        position: absolute;
        bottom: 15px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 4;
        display: flex;
        align-items: center;
      }

      .swiper-pagination {
        display: flex;
        align-items: center;
      }

      .swiper-pagination-bullet {
        width: 10px;
        height: 10px;
        background: rgba(255, 255, 255, 0.4);
        opacity: 1;
        margin: 0 6px !important;
        border-radius: 50%;
        transition: all 0.3s ease;
      }

      .hero.effect-fade .swiper-pagination-bullet-active {
        background: #ffffff;
        width: 25px;
        border-radius: 5px;
      }

      .hero:not(.effect-fade) .swiper-pagination-bullet-active {
        background: #ffffff;
        transform: scale(1.2);
      }

      .hero-control-arrows {
        position: absolute;
        top: 50%;
        left: 0;
        width: 100%;
        transform: translateY(-50%);
        z-index: 4;
        display: flex;
        justify-content: space-between;
        padding: 0 15px;
      }

      .hero-control-prev,
      .hero-control-next {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.5);
        color: #ffffff;
        border: none;
        cursor: pointer;
        font-size: 18px;
        transition: background 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .hero.effect-vertical .hero-control-arrows {
        display: none;
      }

      .hero-control-prev:hover,
      .hero-control-next:hover {
        background: rgba(0, 0, 0, 0.8);
      }
    </style>
  </head>
  <body>
    <!-- 效果切换按钮 -->
    <div class="effect-switcher">
      <button class="effect-btn active" data-effect="fade">1. 全屏淡入淡出</button>
      <button class="effect-btn" data-effect="stack">2. 卡片堆叠</button>
      <button class="effect-btn" data-effect="cube">3. 3D封面流</button>
      <button class="effect-btn" data-effect="vertical">4. 垂直轮播</button>
      <button class="effect-btn" data-effect="cards">5. 无限卡片</button>
      <button class="effect-btn" data-effect="scale">6. 居中缩放</button>
    </div>

    <!-- ========== Hero轮播核心结构 ========== -->
    <div class="hero effect-fade" id="heroCarousel">
      <div class="swiper hero-items" id="swiperContainer">
        <div class="swiper-wrapper">
          <!-- 轮播项1 -->
          <div class="swiper-slide hero-item">
            <div class="hero-item-detail">
              <a href="#" class="hero-item-link">
                <h2 class="hero-item-title">极简陶瓷浴缸</h2>
                <p class="hero-item-description">采用超薄陶瓷工艺，无缝设计，适配现代极简浴室空间。</p>
              </a>
              <span class="hero-item-category">卫浴</span>
            </div>
            <a href="#" class="hero-item-image">
              <img src="http://admin.doporro.com/storage/images/浴缸002.jpg" alt="极简陶瓷浴缸" />
            </a>
          </div>
          <!-- 轮播项2 -->
          <div class="swiper-slide hero-item">
            <div class="hero-item-detail">
              <a href="#" class="hero-item-link">
                <h2 class="hero-item-title">智能淋浴房</h2>
                <p class="hero-item-description">恒温控制+节水技术，360°环绕出水，打造沉浸式沐浴体验。</p>
              </a>
              <span class="hero-item-category">智能卫浴</span>
            </div>
            <a href="#" class="hero-item-image">
              <img src="http://admin.doporro.com/storage/images/淋浴房0909-2.jpg" alt="智能淋浴房" />
            </a>
          </div>
          <!-- 轮播项3 -->
          <div class="swiper-slide hero-item">
            <div class="hero-item-detail">
              <a href="#" class="hero-item-link">
                <h2 class="hero-item-title">一体式浴室柜</h2>
                <p class="hero-item-description">实木材质+防水工艺，超大收纳空间，适配小户型浴室。</p>
              </a>
              <span class="hero-item-category">浴室家具</span>
            </div>
            <a href="#" class="hero-item-image">
              <img
                src="http://admin.doporro.com/storage/images/9cd9a9a87abc840a35254ef34382ecfe.jpg"
                alt="一体式浴室柜"
              />
            </a>
          </div>
        </div>
      </div>

      <!-- 底层模糊背景 -->
      <div class="hero-bg">
        <div class="hero-bg-cover"></div>
        <div class="hero-bg-image">
          <img class="is-active" src="http://admin.doporro.com/storage/images/浴缸002.jpg" alt="浴缸背景" />
          <img src="http://admin.doporro.com/storage/images/淋浴房0909-2.jpg" alt="淋浴房背景" />
          <img
            src="http://admin.doporro.com/storage/images/9cd9a9a87abc840a35254ef34382ecfe.jpg"
            alt="浴室柜背景"
          />
        </div>
      </div>

      <!-- 控制区 -->
      <div class="hero-controls">
        <div class="swiper-pagination"></div>
      </div>

      <!-- 左右切换箭头 -->
      <div class="hero-control-arrows">
        <button class="hero-control-prev">&lt;</button>
        <button class="hero-control-next">&gt;</button>
      </div>
    </div>

    <!-- 引入Swiper插件JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
      let swiper = null
      const heroEl = document.getElementById('heroCarousel')
      const bgImages = document.querySelectorAll('.hero-bg-image img')

      // ========== 不同效果的Swiper配置 ==========
      const effectConfigs = {
        fade: {
          loop: true,
          slidesPerView: 1,
          spaceBetween: 0,
          centeredSlides: false,
          autoplay: {
            delay: 8000,
            disableOnInteraction: false
          },
          speed: 1000,
          pagination: { el: '.swiper-pagination', clickable: true },
          navigation: { nextEl: '.hero-control-next', prevEl: '.hero-control-prev' },
          effect: 'fade',
          fadeEffect: { crossFade: true },
          touchRatio: 1,
          simulateTouch: true
        },
        stack: {
          loop: true,
          slidesPerView: 1,
          spaceBetween: 10,
          centeredSlides: true,
          autoplay: { delay: 5000, disableOnInteraction: false },
          pagination: { el: '.swiper-pagination', clickable: true },
          navigation: { nextEl: '.hero-control-next', prevEl: '.hero-control-prev' },
          effect: 'slide',
          touchRatio: 1.2,
          simulateTouch: true,
          watchSlidesProgress: true,
          watchSlidesVisibility: true
        },
        cube: {
          loop: true,
          slidesPerView: 1,
          spaceBetween: 20,
          centeredSlides: true,
          autoplay: { delay: 6000, disableOnInteraction: false },
          pagination: { el: '.swiper-pagination', clickable: true },
          navigation: { nextEl: '.hero-control-next', prevEl: '.hero-control-prev' },
          effect: 'coverflow',
          coverflowEffect: {
            rotate: 15,
            stretch: 0,
            depth: 80,
            modifier: 2,
            slideShadows: true
          },
          touchRatio: 1,
          simulateTouch: true
        },
        vertical: {
          loop: true,
          slidesPerView: 1,
          spaceBetween: 0,
          centeredSlides: false,
          autoplay: { delay: 5000, disableOnInteraction: false },
          pagination: { el: '.swiper-pagination', clickable: true },
          navigation: { nextEl: '.hero-control-next', prevEl: '.hero-control-prev' },
          direction: 'vertical',
          effect: 'slide',
          touchRatio: 1,
          simulateTouch: true
        },
        cards: {
          loop: true,
          slidesPerView: 'auto',
          spaceBetween: 15,
          centeredSlides: true,
          autoplay: { delay: 5000, disableOnInteraction: false },
          pagination: { el: '.swiper-pagination', clickable: true },
          navigation: { nextEl: '.hero-control-next', prevEl: '.hero-control-prev' },
          effect: 'slide',
          touchRatio: 1.5,
          simulateTouch: true,
          freeMode: true,
          freeModeMomentum: true,
          freeModeMomentumRatio: 0.5,
          watchSlidesProgress: true,
          watchSlidesVisibility: true
        },
        // 效果6：居中缩放（核心修改配置）
        scale: {
          loop: true,
          slidesPerView: 1, // 仅显示1个主卡片
          spaceBetween: 0, // 取消间距，减少位移感
          centeredSlides: true, // 强制卡片居中
          autoplay: { delay: 5000, disableOnInteraction: false },
          pagination: { el: '.swiper-pagination', clickable: true },
          navigation: { nextEl: '.hero-control-next', prevEl: '.hero-control-prev' },
          effect: 'slide', // 保留slide但弱化位移
          speed: 600, // 放慢滑动速度，贴合缩放过渡
          touchRatio: 0.8, // 降低触摸灵敏度，减少滑动距离
          simulateTouch: true,
          watchSlidesProgress: true,
          slideProgress: true,
          // 关键：弱化滑动的位移感
          centeredSlidesBounds: true,
          preventClicks: false
        }
      }

      // ========== 初始化轮播 ==========
      function initSwiper(effectType) {
        if (swiper) {
          swiper.destroy(true, true)
        }

        heroEl.className = 'hero'
        heroEl.classList.add(`effect-${effectType}`)

        const baseConfig = {
          on: {
            slideChange: function () {
              const currentRealIndex = this.realIndex
              bgImages.forEach(img => img.classList.remove('is-active'))
              bgImages[currentRealIndex].classList.add('is-active')
            },
            // 新增：滑动过程中实时更新缩放（替代原progress回调，更稳定）
            setTranslate: function () {
              if (effectType !== 'scale') return
              const slides = this.slides
              for (let i = 0; i < slides.length; i++) {
                const slide = slides[i]
                const progress = slide.progress || 0
                // 仅保留缩放/透明度，取消位移相关计算
                const opacity = Math.max(1 - Math.abs(progress) * 0.8, 0.4)
                const scale = 1 - Math.abs(progress) * 0.2
                slide.style.opacity = opacity
                slide.style.transform = `scale(${scale}) translateZ(0)`
                // 强制重置位移，只保留缩放
                slide.style.left = '0'
                slide.style.right = '0'
              }
            }
          }
        }

        const config = {
          ...effectConfigs[effectType],
          ...baseConfig
        }

        swiper = new Swiper('#swiperContainer', config)
      }

      // ========== 效果切换按钮逻辑 ==========
      document.querySelectorAll('.effect-btn').forEach(btn => {
        btn.addEventListener('click', function () {
          document.querySelectorAll('.effect-btn').forEach(b => b.classList.remove('active'))
          this.classList.add('active')
          initSwiper(this.dataset.effect)
        })
      })

      // 页面加载初始化
      document.addEventListener('DOMContentLoaded', function () {
        initSwiper('fade')
      })
    </script>
  </body>
</html>
